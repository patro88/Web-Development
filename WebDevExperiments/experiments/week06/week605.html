<!DOCTYPE html>
<html>
<head>
    <title> Customized Book API </title>
    <link rel="stylesheet" href="../bootstrap-3.3.2-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../bootstrap-3.3.2-dist/css/bootstrap-theme.min.css">
    <script src=" http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="../js/angular.min.js"></script>
    <script src="../js/angular-route.min.js"></script>
</head>
<body>

    <div class="container">
        <h1>
            Customized Book API
        </h1>
        <hr />
        <h2>Description:</h2>
        <p>
            In this experiment I extended the <a href="week604.html"> Experiment 4</a> to add crud operations on server data.
            The data I used is the same json I used in previous experiments. I added add book, delete book, update book and insert book operations using bootstrap buttons.
            I used the concepts learned from previous experiments to add the functionalities.

        </p>
        <hr />
        <h3>Book API :</h3>

        <div>
            <div style="margin: 20px;">
                Click<a href="http://nodejs-shakti200.rhcloud.com/"> <strong>here</strong> </a> to launch the customized Book API.
            </div>
            <div>
                <img src="../images/image606.jpg" class="img-thumbnail" />
            </div>
        </div>


        <hr />
        <div class="container-fluid">
            <h3>Code Snippet</h3>

            <div class="label-info">Server.js Code : </div><br />
            <p>
                In server.js , I added add, delete and update urls. These are post, delete and put requests in order.
                As per the request, I modified the json object at teh server.
                <br />
                Also I added <code>body-parser</code> and <code>multer</code> code for parsing body of the request.

                Please look into <a href="week604.html">Experiment 604</a>  for other details.
            </p>
            
            <code>
                var bodyParser = require('body-parser');<br />
                var multer = require('multer');<br />
                <br />
                app.use(bodyParser.json()); // for parsing application/json<br />
                app.use(bodyParser.urlencoded({ extended: true })); // for parsing application/x-www-form-urlencoded<br />
                app.use(multer()); // for parsing multipart/form-data<br />
                <br /><br /><br />


                app.delete("/api/book/:id", function (req, res) {<br />
                books.splice(req.params.id, 1);<br />
                res.json(books);<br />
                })<br />
                <br />
                app.post("/api/book", function (req, res) {<br />
                books.push(req.body);<br />
                res.json(books);<br />
                })<br />
                <br />
                app.put("/api/book/:id", function (req, res) {<br />
                books[req.params.id] = req.body;<br />
                res.json(books);<br />
                })<br />
                <br />
            </code>
           
           
            <div class="label-info">Client side Code : </div><br />
            <p>
                In the client side, I added functions for the operations to be performed on the rows.This was very similar to the code written in previous week.
                <a href="../week05/week504.html">Experiment 504</a><br />
                Below is a snippet for the select and update methods.
                <br /> 
             
            </p>
            <code>

                $scope.select = function (index)<br />
                {<br />
                $scope.selectedIndex = index;<br />
                $scope.book = $scope.booklist[index];<br />
                }<br />
                $scope.update = function (book) {<br />
                $http.put("/api/book/" + $scope.selectedIndex, book) // update a particular row<br />
                .success(function (response) {<br />
                $scope.booklist = response;// update the list after a row has been updated<br />
                });<br />

                };<br />
                <br />
            </code>
            
            <hr />
            <h3> View Source : </h3>
            <a href="../../fileview/Default.aspx?~/experiments/week06/week605.html" target="_blank"> HTML </a><br />
            <p>
                <h3> Reference :</h3>
                <a href="http://nodejs.org/" target="_blank"> NodeJS </a><br />
                <a href="https://angularjs.org/" target="_blank"> Angular JS </a><br />
            </p>

            <hr />


        </div>


</body>
</html>
